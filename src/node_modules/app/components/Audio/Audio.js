// @flow

import {observer} from "mobx-react";
import React from "react";

import SceneStore from "app/stores/SceneStore";

@observer
export default class Audio extends React.PureComponent {
    props: {
        src: string,
        volume?: number,
        mute?: boolean,
        autoPlay?: boolean,
        loop?: boolean
    };

    refs: {
        audio: HTMLMediaElement
    };

    updateVolume() {
        let volume = 100;
        if (this.props.mute) volume = 0;
        else if (typeof this.props.volume !== 'undefined') volume = this.props.volume;

        this.refs.audio.volume = volume;
    }

    componentDidMount() {
        this.updateVolume();
    }

    componentDidUpdate() {
        this.updateVolume();
    }

    render() {
        return (
            <audio ref="audio"
                   src={SceneStore.music}
                   autoPlay={this.props.autoPlay}
                   loop={this.props.loop}
            />
        );
    }
}
