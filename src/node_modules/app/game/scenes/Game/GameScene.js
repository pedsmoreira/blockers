// @flow

import {observer} from "mobx-react";
import React from "react";

import GameStore from "app/stores/GameStore";
import SceneStore from "app/stores/SceneStore";

import Playground from "app/components/Playground/Playground";
import CharacterMenu from "app/components/CharacterMenu/CharacterMenu";
import StageMenu from "app/components/StageMenu/StageMenu";
import ScoreMenu from "app/components/ScoreMenu/ScoreMenu";
import SpellsMenu from "app/components/SpellsMenu/SpellsMenu";
import DifficultyMenu from "app/components/DifficultyMenu/DifficultyMenu";

import music from "app/assets/sounds/game.mp3";
import "./GameScene.scss";

@observer
export default class GameScene extends React.PureComponent {
    componentWillMount() {
        SceneStore.setBackground(GameStore.stageClass.background);
        SceneStore.setMusic(music);
        GameStore.play();
    }

    render() {
        return (
            <div className="GameScene">
                <div className="container">
                    <div className="GameScene-mainMenu">
                        <CharacterMenu character={GameStore.character}/>
                        <SpellsMenu spells={GameStore.character.spells}/>
                    </div>

                    <div className="GameScene-playingField">
                        <Playground matrix={GameStore.matrix}
                                    piece={GameStore.piece}
                                    piecePosition={GameStore.piecePosition}
                                    effects={GameStore.effects}/>
                    </div>

                    <div className="GameScene-secondaryMenu">
                        <DifficultyMenu difficulty={GameStore.difficulty} linesCleared={GameStore.linesCleared}/>
                        <ScoreMenu experience={GameStore.character.experience} linesCleared={GameStore.linesCleared}/>
                        <StageMenu stage={GameStore.stage} mode={GameStore.mode}/>
                    </div>
                </div>
            </div>
        )
    }
}
