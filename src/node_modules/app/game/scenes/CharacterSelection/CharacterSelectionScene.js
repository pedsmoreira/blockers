// @flow

import {observer} from "mobx-react";
import React from "react";

import GameStore from "app/stores/GameStore";
import SceneStore from "app/stores/SceneStore";

import Batman from "app/game/characters/Batman/Batman";
import Medusa from "app/game/characters/Medusa/Medusa";

import GameScene from "app/game/scenes/Game/GameScene";

import CharacterCard from "app/components/CharacterCard/CharacterCard";

import background from "app/assets/images/background.jpg";
import music from "app/assets/sounds/intro.mp3";

import "./CharacterSelectionScene.scss";

@observer
export default class CharacterSelectionScene extends React.PureComponent {
    static selectCharacter(characterClass: Function) {
        GameStore.selectCharacter(characterClass);

        GameStore.selectStage(characterClass.stage);
        SceneStore.setScene(<GameScene/>)
    }

    componentWillMount() {
        SceneStore.setBackground(background);
        SceneStore.setMusic(music);
    }

    render() {
        const characters = [Batman, Medusa].map((characterClass: Function) => {
            return <CharacterCard key={characterClass.slug} characterClass={characterClass}
                                  callback={() => this.constructor.selectCharacter(characterClass)}/>
        });

        return (
            <div className="CharacterSelectionScene">
                <div className="container">
                    <header>
                        <h1>Choose your Character</h1>
                    </header>

                    <div className="CharacterSelectionScene-cards">
                        {characters}
                    </div>
                </div>
            </div>
        )
    }
}
